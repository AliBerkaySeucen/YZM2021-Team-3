{"ast":null,"code":"import React,{useCallback,useState,useEffect}from'react';import ReactFlow,{Controls,Background,useNodesState,useEdgesState,BackgroundVariant,MarkerType}from'reactflow';import'reactflow/dist/style.css';import{useMemory}from'../context/MemoryContext';import MemoryModal from'../components/MemoryModal';import'./MemoryGraph.css';import'./Album.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const MemoryGraph=()=>{const{memories,connections,addConnection,deleteConnection,deleteMemory,updateMemoryPosition}=useMemory();const[nodes,setNodes,onNodesChange]=useNodesState([]);const[edges,setEdges,onEdgesChange]=useEdgesState([]);const[isModalOpen,setIsModalOpen]=useState(false);const[isConnectMode,setIsConnectMode]=useState(false);const[isFullscreen,setIsFullscreen]=useState(false);const[selectedNodeForConnect,setSelectedNodeForConnect]=useState(null);const[selectedMemoryId,setSelectedMemoryId]=useState(null);const[showDeleteConfirm,setShowDeleteConfirm]=useState(false);const[deleteTarget,setDeleteTarget]=useState(null);const[reactFlowInstance,setReactFlowInstance]=useState(null);// Convert memories to nodes with stable positions\nuseEffect(()=>{const newNodes=memories.filter(memory=>memory&&memory.id&&memory.image)// Filter out invalid memories\n.map((memory,index)=>{// Use existing position if available, otherwise calculate stable position\nlet position=memory.position;// If no position exists, calculate a stable grid-based position\nif(!position||position.x===0&&position.y===0){const cols=5;// Number of columns in grid\nconst spacing=200;// Space between nodes\nconst row=Math.floor(index/cols);const col=index%cols;position={x:col*spacing+100,y:row*spacing+100};// Save this position to backend so it persists\nupdateMemoryPosition(memory.id,position);}return{id:memory.id,type:'default',position:position,data:{label:/*#__PURE__*/_jsx(\"div\",{className:\"node-content\",children:/*#__PURE__*/_jsx(\"img\",{src:memory.image,alt:memory.title,className:\"node-image\",loading:\"lazy\",decoding:\"async\",style:{contentVisibility:'auto'}})})},selectable:true,draggable:true,connectable:false,style:{background:'#3B82F6',border:'3px solid #60A5FA',borderRadius:'12px',padding:0,width:120,height:90}};});setNodes(newNodes);},[memories,setNodes,updateMemoryPosition]);// Convert connections to edges\nuseEffect(()=>{const newEdges=connections.map(conn=>({id:conn.id,source:conn.source,target:conn.target,type:'smoothstep',animated:false,style:{stroke:'#A855F7',strokeWidth:3},markerEnd:{type:MarkerType.ArrowClosed,color:'#A855F7'}}));setEdges(newEdges);},[connections,setEdges]);const onConnect=useCallback(params=>{if(params.source&&params.target){addConnection(params.source,params.target);}},[addConnection]);const onNodeDragStop=useCallback((_,node)=>{updateMemoryPosition(node.id,node.position);},[updateMemoryPosition]);const handleNodeClick=useCallback((_,node)=>{if(isConnectMode){if(!selectedNodeForConnect){setSelectedNodeForConnect(node.id);}else{if(selectedNodeForConnect!==node.id){addConnection(selectedNodeForConnect,node.id);}setSelectedNodeForConnect(null);setIsConnectMode(false);}}else{setSelectedMemoryId(node.id);}},[isConnectMode,selectedNodeForConnect,addConnection]);const handleDelete=()=>{const selectedNodes=nodes.filter(node=>node.selected);const selectedEdges=edges.filter(edge=>edge.selected);if(selectedNodes.length===0&&selectedEdges.length===0){return;}setDeleteTarget({nodes:selectedNodes.map(n=>n.id),edges:selectedEdges.map(e=>e.id)});setShowDeleteConfirm(true);};const confirmDelete=()=>{if(deleteTarget){deleteTarget.edges.forEach(edgeId=>deleteConnection(edgeId));deleteTarget.nodes.forEach(nodeId=>deleteMemory(nodeId));setDeleteTarget(null);setShowDeleteConfirm(false);}};const cancelDelete=()=>{setDeleteTarget(null);setShowDeleteConfirm(false);};const handleZoomIn=()=>{reactFlowInstance===null||reactFlowInstance===void 0?void 0:reactFlowInstance.zoomIn();};const handleZoomOut=()=>{reactFlowInstance===null||reactFlowInstance===void 0?void 0:reactFlowInstance.zoomOut();};const handleFitView=()=>{reactFlowInstance===null||reactFlowInstance===void 0?void 0:reactFlowInstance.fitView();};// Get connected memories for a given memory\nconst getConnectedMemories=memoryId=>{const outgoingConnections=connections.filter(c=>c.source===memoryId).map(c=>memories.find(m=>m.id===c.target)).filter(m=>m!==undefined);const incomingConnections=connections.filter(c=>c.target===memoryId).map(c=>memories.find(m=>m.id===c.source)).filter(m=>m!==undefined);return{outgoing:outgoingConnections,incoming:incomingConnections};};const toggleFullscreen=()=>{const element=document.querySelector('.memory-graph-page');if(!document.fullscreenElement){element.requestFullscreen().then(()=>{setIsFullscreen(true);}).catch(err=>{console.error('Error attempting to enable fullscreen:',err);});}else{document.exitFullscreen().then(()=>{setIsFullscreen(false);});}};return/*#__PURE__*/_jsxs(\"div\",{className:\"memory-graph-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"graph-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"graph-header-content\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"graph-title\",children:\"\\u0130nteraktif Graf Haritas\\u0131\"}),/*#__PURE__*/_jsx(\"p\",{className:\"graph-subtitle\",children:\"Haritada gezinin, yak\\u0131nla\\u015Ft\\u0131r\\u0131n ve d\\xFC\\u011F\\xFCmleri y\\xF6netin\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"graph-toolbar\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"toolbar-btn btn-add\",onClick:()=>setIsModalOpen(true),title:\"Add new memory node\",children:[/*#__PURE__*/_jsxs(\"svg\",{width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:[/*#__PURE__*/_jsx(\"line\",{x1:\"12\",y1:\"5\",x2:\"12\",y2:\"19\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"5\",y1:\"12\",x2:\"19\",y2:\"12\"})]}),/*#__PURE__*/_jsx(\"span\",{children:\"D\\xFC\\u011F\\xFCm Ekle\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"toolbar-btn btn-connect \".concat(isConnectMode?'active':''),onClick:()=>{setIsConnectMode(!isConnectMode);setSelectedNodeForConnect(null);},title:\"Drag from one node to another to connect\",children:[/*#__PURE__*/_jsxs(\"svg\",{width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"})]}),/*#__PURE__*/_jsx(\"span\",{children:\"Ba\\u011Flant\\u0131 Ekle\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"toolbar-btn btn-delete\",onClick:handleDelete,title:\"Delete selected items\",children:[/*#__PURE__*/_jsxs(\"svg\",{width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:[/*#__PURE__*/_jsx(\"polyline\",{points:\"3 6 5 6 21 6\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"10\",y1:\"11\",x2:\"10\",y2:\"17\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"14\",y1:\"11\",x2:\"14\",y2:\"17\"})]}),/*#__PURE__*/_jsx(\"span\",{children:\"Sil\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"toolbar-btn btn-fullscreen\",onClick:toggleFullscreen,title:isFullscreen?\"Exit fullscreen\":\"Enter fullscreen\",children:[isFullscreen?/*#__PURE__*/_jsx(\"svg\",{width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3\"})}):/*#__PURE__*/_jsx(\"svg\",{width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3\"})}),/*#__PURE__*/_jsx(\"span\",{children:isFullscreen?'√áƒ±kƒ±≈ü':'Tam Ekran'})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"graph-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"graph-wrapper\",children:/*#__PURE__*/_jsxs(ReactFlow,{nodes:nodes,edges:edges,onNodesChange:onNodesChange,onEdgesChange:onEdgesChange,onNodeDragStop:onNodeDragStop,onNodeClick:handleNodeClick,onInit:setReactFlowInstance,fitView:true,attributionPosition:\"bottom-left\",children:[/*#__PURE__*/_jsx(Background,{variant:BackgroundVariant.Dots,gap:12,size:1,color:\"#334155\"}),/*#__PURE__*/_jsx(Controls,{showInteractive:false})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"custom-controls\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"control-btn\",onClick:handleZoomIn,title:\"Zoom in\",children:/*#__PURE__*/_jsxs(\"svg\",{width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:[/*#__PURE__*/_jsx(\"circle\",{cx:\"11\",cy:\"11\",r:\"8\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"21\",y1:\"21\",x2:\"16.65\",y2:\"16.65\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"11\",y1:\"8\",x2:\"11\",y2:\"14\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"8\",y1:\"11\",x2:\"14\",y2:\"11\"})]})}),/*#__PURE__*/_jsx(\"button\",{className:\"control-btn\",onClick:handleZoomOut,title:\"Zoom out\",children:/*#__PURE__*/_jsxs(\"svg\",{width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:[/*#__PURE__*/_jsx(\"circle\",{cx:\"11\",cy:\"11\",r:\"8\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"21\",y1:\"21\",x2:\"16.65\",y2:\"16.65\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"8\",y1:\"11\",x2:\"14\",y2:\"11\"})]})}),/*#__PURE__*/_jsx(\"button\",{className:\"control-btn\",onClick:handleFitView,title:\"Fit view\",children:/*#__PURE__*/_jsx(\"svg\",{width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3\"})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"zoom-indicator\",children:[\"Zoom: \",reactFlowInstance?Math.round(reactFlowInstance.getZoom()*100):100,\"%\"]}),isConnectMode&&/*#__PURE__*/_jsxs(\"div\",{className:\"connect-mode-hint\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"hint-icon\",children:\"\\uD83D\\uDCA1\"}),/*#__PURE__*/_jsx(\"span\",{className:\"hint-text\",children:\"Connection Mode: Drag from one node's edge to another node to create a connection. Click the button again to exit.\"})]})]}),/*#__PURE__*/_jsx(MemoryModal,{isOpen:isModalOpen,onClose:()=>setIsModalOpen(false)}),selectedMemoryId&&memories.find(m=>m.id===selectedMemoryId)&&/*#__PURE__*/_jsx(\"div\",{className:\"memory-popup-overlay\",onClick:()=>setSelectedMemoryId(null),children:/*#__PURE__*/_jsxs(\"div\",{className:\"memory-popup-content\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"button\",{className:\"popup-close-btn\",onClick:()=>setSelectedMemoryId(null),children:/*#__PURE__*/_jsxs(\"svg\",{width:\"24\",height:\"24\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:[/*#__PURE__*/_jsx(\"line\",{x1:\"18\",y1:\"6\",x2:\"6\",y2:\"18\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"6\",y1:\"6\",x2:\"18\",y2:\"18\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"popup-image-container\",children:/*#__PURE__*/_jsx(\"img\",{src:memories.find(m=>m.id===selectedMemoryId).image,alt:memories.find(m=>m.id===selectedMemoryId).title,className:\"popup-image\",loading:\"eager\",decoding:\"async\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"popup-info\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"popup-title\",children:memories.find(m=>m.id===selectedMemoryId).title}),/*#__PURE__*/_jsx(\"p\",{className:\"popup-description\",children:memories.find(m=>m.id===selectedMemoryId).description}),memories.find(m=>m.id===selectedMemoryId).tags&&memories.find(m=>m.id===selectedMemoryId).tags.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"popup-tags\",children:memories.find(m=>m.id===selectedMemoryId).tags.map(tag=>/*#__PURE__*/_jsx(\"span\",{className:\"popup-tag\",children:tag},tag))}),/*#__PURE__*/_jsx(\"div\",{className:\"popup-date\",children:memories.find(m=>m.id===selectedMemoryId).date?/*#__PURE__*/_jsxs(_Fragment,{children:[\"Memory Date: \",new Date(memories.find(m=>m.id===selectedMemoryId).date).toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[\"Added: \",new Date(memories.find(m=>m.id===selectedMemoryId).createdAt).toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'})]})}),(()=>{const connectedMemories=getConnectedMemories(selectedMemoryId);const hasConnections=connectedMemories.outgoing.length>0||connectedMemories.incoming.length>0;return hasConnections&&/*#__PURE__*/_jsxs(\"div\",{className:\"popup-connections\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"connections-title\",children:\"Connections\"}),connectedMemories.outgoing.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"connection-group\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"connection-group-header\",children:[/*#__PURE__*/_jsxs(\"svg\",{className:\"connection-icon\",width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:[/*#__PURE__*/_jsx(\"line\",{x1:\"5\",y1:\"12\",x2:\"19\",y2:\"12\"}),/*#__PURE__*/_jsx(\"polyline\",{points:\"12 5 19 12 12 19\"})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"connection-label\",children:[\"Outgoing Links (\",connectedMemories.outgoing.length,\")\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"connection-list\",children:connectedMemories.outgoing.map(memory=>/*#__PURE__*/_jsxs(\"div\",{className:\"connection-item\",onClick:e=>{e.stopPropagation();setSelectedMemoryId(memory.id);},children:[/*#__PURE__*/_jsx(\"img\",{src:memory.image,alt:memory.title,className:\"connection-thumbnail\",loading:\"lazy\",decoding:\"async\"}),/*#__PURE__*/_jsx(\"span\",{className:\"connection-name\",children:memory.title})]},memory.id))})]}),connectedMemories.incoming.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"connection-group\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"connection-group-header\",children:[/*#__PURE__*/_jsxs(\"svg\",{className:\"connection-icon\",width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:[/*#__PURE__*/_jsx(\"line\",{x1:\"19\",y1:\"12\",x2:\"5\",y2:\"12\"}),/*#__PURE__*/_jsx(\"polyline\",{points:\"12 19 5 12 12 5\"})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"connection-label\",children:[\"Incoming Links (\",connectedMemories.incoming.length,\")\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"connection-list\",children:connectedMemories.incoming.map(memory=>/*#__PURE__*/_jsxs(\"div\",{className:\"connection-item\",onClick:e=>{e.stopPropagation();setSelectedMemoryId(memory.id);},children:[/*#__PURE__*/_jsx(\"img\",{src:memory.image,alt:memory.title,className:\"connection-thumbnail\",loading:\"lazy\",decoding:\"async\"}),/*#__PURE__*/_jsx(\"span\",{className:\"connection-name\",children:memory.title})]},memory.id))})]})]});})()]})]})}),showDeleteConfirm&&deleteTarget&&/*#__PURE__*/_jsx(\"div\",{className:\"delete-confirm-overlay\",onClick:cancelDelete,children:/*#__PURE__*/_jsxs(\"div\",{className:\"delete-confirm-dialog\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"div\",{className:\"delete-confirm-icon\",children:/*#__PURE__*/_jsxs(\"svg\",{width:\"48\",height:\"48\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",children:[/*#__PURE__*/_jsx(\"path\",{d:\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"12\",y1:\"9\",x2:\"12\",y2:\"13\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"12\",y1:\"17\",x2:\"12.01\",y2:\"17\"})]})}),/*#__PURE__*/_jsx(\"h2\",{className:\"delete-confirm-title\",children:\"Delete Selected Items?\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"delete-confirm-message\",children:[(()=>{const nodeCount=deleteTarget.nodes.length;const edgeCount=deleteTarget.edges.length;const totalCount=nodeCount+edgeCount;if(nodeCount>0&&edgeCount>0){return\"Are you sure you want to delete \".concat(nodeCount,\" memor\").concat(nodeCount>1?'ies':'y',\" and \").concat(edgeCount,\" connection\").concat(edgeCount>1?'s':'',\"?\");}else if(nodeCount>0){return\"Are you sure you want to delete \".concat(nodeCount,\" memor\").concat(nodeCount>1?'ies':'y',\"?\");}else{return\"Are you sure you want to delete \".concat(edgeCount,\" connection\").concat(edgeCount>1?'s':'',\"?\");}})(),deleteTarget.nodes.length>0&&/*#__PURE__*/_jsxs(\"span\",{className:\"delete-warning\",children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),\"\\u26A0\\uFE0F Deleting memories will also remove all their connections.\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"delete-confirm-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"delete-confirm-cancel\",onClick:cancelDelete,children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{className:\"delete-confirm-delete\",onClick:confirmDelete,children:\"Delete\"})]})]})})]});};export default MemoryGraph;","map":{"version":3,"names":["React","useCallback","useState","useEffect","ReactFlow","Controls","Background","useNodesState","useEdgesState","BackgroundVariant","MarkerType","useMemory","MemoryModal","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","MemoryGraph","memories","connections","addConnection","deleteConnection","deleteMemory","updateMemoryPosition","nodes","setNodes","onNodesChange","edges","setEdges","onEdgesChange","isModalOpen","setIsModalOpen","isConnectMode","setIsConnectMode","isFullscreen","setIsFullscreen","selectedNodeForConnect","setSelectedNodeForConnect","selectedMemoryId","setSelectedMemoryId","showDeleteConfirm","setShowDeleteConfirm","deleteTarget","setDeleteTarget","reactFlowInstance","setReactFlowInstance","newNodes","filter","memory","id","image","map","index","position","x","y","cols","spacing","row","Math","floor","col","type","data","label","className","children","src","alt","title","loading","decoding","style","contentVisibility","selectable","draggable","connectable","background","border","borderRadius","padding","width","height","newEdges","conn","source","target","animated","stroke","strokeWidth","markerEnd","ArrowClosed","color","onConnect","params","onNodeDragStop","_","node","handleNodeClick","handleDelete","selectedNodes","selected","selectedEdges","edge","length","n","e","confirmDelete","forEach","edgeId","nodeId","cancelDelete","handleZoomIn","zoomIn","handleZoomOut","zoomOut","handleFitView","fitView","getConnectedMemories","memoryId","outgoingConnections","c","find","m","undefined","incomingConnections","outgoing","incoming","toggleFullscreen","element","document","querySelector","fullscreenElement","requestFullscreen","then","catch","err","console","error","exitFullscreen","onClick","viewBox","fill","x1","y1","x2","y2","concat","d","points","onNodeClick","onInit","attributionPosition","variant","Dots","gap","size","showInteractive","cx","cy","r","round","getZoom","isOpen","onClose","stopPropagation","description","tags","tag","date","Date","toLocaleDateString","year","month","day","createdAt","connectedMemories","hasConnections","nodeCount","edgeCount","totalCount"],"sources":["/Users/berat/YZM2021-Team-3/src/pages/MemoryGraph.tsx"],"sourcesContent":["import React, { useCallback, useState, useEffect } from 'react';\nimport ReactFlow, {\n  Controls,\n  Background,\n  useNodesState,\n  useEdgesState,\n  Connection,\n  Edge,\n  Node,\n  BackgroundVariant,\n  MarkerType,\n  ConnectionMode,\n} from 'reactflow';\nimport 'reactflow/dist/style.css';\nimport { useMemory } from '../context/MemoryContext';\nimport MemoryModal from '../components/MemoryModal';\nimport './MemoryGraph.css';\nimport './Album.css';\n\nconst MemoryGraph: React.FC = () => {\n  const { memories, connections, addConnection, deleteConnection, deleteMemory, updateMemoryPosition } = useMemory();\n  const [nodes, setNodes, onNodesChange] = useNodesState([]);\n  const [edges, setEdges, onEdgesChange] = useEdgesState([]);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [isConnectMode, setIsConnectMode] = useState(false);\n  const [isFullscreen, setIsFullscreen] = useState(false);\n  const [selectedNodeForConnect, setSelectedNodeForConnect] = useState<string | null>(null);\n  const [selectedMemoryId, setSelectedMemoryId] = useState<string | null>(null);\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\n  const [deleteTarget, setDeleteTarget] = useState<{ nodes: string[], edges: string[] } | null>(null);\n  const [reactFlowInstance, setReactFlowInstance] = useState<any>(null);\n\n  // Convert memories to nodes with stable positions\n  useEffect(() => {\n    const newNodes: Node[] = memories\n      .filter(memory => memory && memory.id && memory.image) // Filter out invalid memories\n      .map((memory, index) => {\n        // Use existing position if available, otherwise calculate stable position\n        let position = memory.position;\n        \n        // If no position exists, calculate a stable grid-based position\n        if (!position || (position.x === 0 && position.y === 0)) {\n          const cols = 5; // Number of columns in grid\n          const spacing = 200; // Space between nodes\n          const row = Math.floor(index / cols);\n          const col = index % cols;\n          \n          position = {\n            x: col * spacing + 100,\n            y: row * spacing + 100\n          };\n          \n          // Save this position to backend so it persists\n          updateMemoryPosition(memory.id, position);\n        }\n        \n        return {\n          id: memory.id,\n          type: 'default',\n          position: position,\n          data: {\n            label: (\n              <div className=\"node-content\">\n                <img \n                  src={memory.image} \n                  alt={memory.title} \n                  className=\"node-image\" \n                  loading=\"lazy\"\n                  decoding=\"async\"\n                  style={{ contentVisibility: 'auto' }}\n                />\n              </div>\n            ),\n          },\n          selectable: true,\n          draggable: true,\n          connectable: false,\n          style: {\n            background: '#3B82F6',\n            border: '3px solid #60A5FA',\n            borderRadius: '12px',\n            padding: 0,\n            width: 120,\n            height: 90,\n          },\n        };\n      });\n    setNodes(newNodes);\n  }, [memories, setNodes, updateMemoryPosition]);\n\n  // Convert connections to edges\n  useEffect(() => {\n    const newEdges: Edge[] = connections.map(conn => ({\n      id: conn.id,\n      source: conn.source,\n      target: conn.target,\n      type: 'smoothstep',\n      animated: false,\n      style: { stroke: '#A855F7', strokeWidth: 3 },\n      markerEnd: {\n        type: MarkerType.ArrowClosed,\n        color: '#A855F7',\n      },\n    }));\n    setEdges(newEdges);\n  }, [connections, setEdges]);\n\n  const onConnect = useCallback(\n    (params: Connection) => {\n      if (params.source && params.target) {\n        addConnection(params.source, params.target);\n      }\n    },\n    [addConnection]\n  );\n\n  const onNodeDragStop = useCallback(\n    (_: any, node: Node) => {\n      updateMemoryPosition(node.id, node.position);\n    },\n    [updateMemoryPosition]\n  );\n\n  const handleNodeClick = useCallback(\n    (_: any, node: Node) => {\n      if (isConnectMode) {\n        if (!selectedNodeForConnect) {\n          setSelectedNodeForConnect(node.id);\n        } else {\n          if (selectedNodeForConnect !== node.id) {\n            addConnection(selectedNodeForConnect, node.id);\n          }\n          setSelectedNodeForConnect(null);\n          setIsConnectMode(false);\n        }\n      } else {\n        setSelectedMemoryId(node.id);\n      }\n    },\n    [isConnectMode, selectedNodeForConnect, addConnection]\n  );\n\n  const handleDelete = () => {\n    const selectedNodes = nodes.filter((node: any) => node.selected);\n    const selectedEdges = edges.filter((edge: any) => edge.selected);\n\n    if (selectedNodes.length === 0 && selectedEdges.length === 0) {\n      return;\n    }\n\n    setDeleteTarget({\n      nodes: selectedNodes.map(n => n.id),\n      edges: selectedEdges.map(e => e.id)\n    });\n    setShowDeleteConfirm(true);\n  };\n\n  const confirmDelete = () => {\n    if (deleteTarget) {\n      deleteTarget.edges.forEach(edgeId => deleteConnection(edgeId));\n      deleteTarget.nodes.forEach(nodeId => deleteMemory(nodeId));\n      setDeleteTarget(null);\n      setShowDeleteConfirm(false);\n    }\n  };\n\n  const cancelDelete = () => {\n    setDeleteTarget(null);\n    setShowDeleteConfirm(false);\n  };\n\n  const handleZoomIn = () => {\n    reactFlowInstance?.zoomIn();\n  };\n\n  const handleZoomOut = () => {\n    reactFlowInstance?.zoomOut();\n  };\n\n  const handleFitView = () => {\n    reactFlowInstance?.fitView();\n  };\n\n  // Get connected memories for a given memory\n  const getConnectedMemories = (memoryId: string) => {\n    const outgoingConnections = connections\n      .filter(c => c.source === memoryId)\n      .map(c => memories.find(m => m.id === c.target))\n      .filter(m => m !== undefined);\n    \n    const incomingConnections = connections\n      .filter(c => c.target === memoryId)\n      .map(c => memories.find(m => m.id === c.source))\n      .filter(m => m !== undefined);\n    \n    return { outgoing: outgoingConnections, incoming: incomingConnections };\n  };\n\n  const toggleFullscreen = () => {\n    const element = document.querySelector('.memory-graph-page') as HTMLElement;\n    \n    if (!document.fullscreenElement) {\n      element.requestFullscreen().then(() => {\n        setIsFullscreen(true);\n      }).catch(err => {\n        console.error('Error attempting to enable fullscreen:', err);\n      });\n    } else {\n      document.exitFullscreen().then(() => {\n        setIsFullscreen(false);\n      });\n    }\n  };\n\n  return (\n    <div className=\"memory-graph-page\">\n      <div className=\"graph-header\">\n        <div className=\"graph-header-content\">\n          <h1 className=\"graph-title\">ƒ∞nteraktif Graf Haritasƒ±</h1>\n          <p className=\"graph-subtitle\">Haritada gezinin, yakƒ±nla≈ütƒ±rƒ±n ve d√ºƒü√ºmleri y√∂netin</p>\n        </div>\n        \n        <div className=\"graph-toolbar\">\n          <button \n            className=\"toolbar-btn btn-add\" \n            onClick={() => setIsModalOpen(true)}\n            title=\"Add new memory node\"\n          >\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n              <line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\"></line>\n              <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"></line>\n            </svg>\n            <span>D√ºƒü√ºm Ekle</span>\n          </button>\n          <button\n            className={`toolbar-btn btn-connect ${isConnectMode ? 'active' : ''}`}\n            onClick={() => {\n              setIsConnectMode(!isConnectMode);\n              setSelectedNodeForConnect(null);\n            }}\n            title=\"Drag from one node to another to connect\"\n          >\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n              <path d=\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"></path>\n              <path d=\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"></path>\n            </svg>\n            <span>Baƒülantƒ± Ekle</span>\n          </button>\n          <button \n            className=\"toolbar-btn btn-delete\" \n            onClick={handleDelete}\n            title=\"Delete selected items\"\n          >\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n              <polyline points=\"3 6 5 6 21 6\"></polyline>\n              <path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"></path>\n              <line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\"></line>\n              <line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\"></line>\n            </svg>\n            <span>Sil</span>\n          </button>\n          <button \n            className=\"toolbar-btn btn-fullscreen\" \n            onClick={toggleFullscreen}\n            title={isFullscreen ? \"Exit fullscreen\" : \"Enter fullscreen\"}\n          >\n            {isFullscreen ? (\n              <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                <path d=\"M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3\"></path>\n              </svg>\n            ) : (\n              <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                <path d=\"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3\"></path>\n              </svg>\n            )}\n            <span>{isFullscreen ? '√áƒ±kƒ±≈ü' : 'Tam Ekran'}</span>\n          </button>\n        </div>\n      </div>\n\n      <div className=\"graph-container\">\n        <div className=\"graph-wrapper\">\n          <ReactFlow\n            nodes={nodes}\n            edges={edges}\n            onNodesChange={onNodesChange}\n            onEdgesChange={onEdgesChange}\n            onNodeDragStop={onNodeDragStop}\n            onNodeClick={handleNodeClick}\n            onInit={setReactFlowInstance}\n            fitView\n            attributionPosition=\"bottom-left\"\n          >\n            <Background variant={BackgroundVariant.Dots} gap={12} size={1} color=\"#334155\" />\n            <Controls showInteractive={false} />\n          </ReactFlow>\n        </div>\n\n        <div className=\"custom-controls\">\n          <button className=\"control-btn\" onClick={handleZoomIn} title=\"Zoom in\">\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n              <circle cx=\"11\" cy=\"11\" r=\"8\"></circle>\n              <line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\"></line>\n              <line x1=\"11\" y1=\"8\" x2=\"11\" y2=\"14\"></line>\n              <line x1=\"8\" y1=\"11\" x2=\"14\" y2=\"11\"></line>\n            </svg>\n          </button>\n          <button className=\"control-btn\" onClick={handleZoomOut} title=\"Zoom out\">\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n              <circle cx=\"11\" cy=\"11\" r=\"8\"></circle>\n              <line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\"></line>\n              <line x1=\"8\" y1=\"11\" x2=\"14\" y2=\"11\"></line>\n            </svg>\n          </button>\n          <button className=\"control-btn\" onClick={handleFitView} title=\"Fit view\">\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n              <path d=\"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3\"></path>\n            </svg>\n          </button>\n        </div>\n\n        <div className=\"zoom-indicator\">\n          Zoom: {reactFlowInstance ? Math.round(reactFlowInstance.getZoom() * 100) : 100}%\n        </div>\n\n        {isConnectMode && (\n          <div className=\"connect-mode-hint\">\n            <span className=\"hint-icon\">üí°</span>\n            <span className=\"hint-text\">\n              Connection Mode: Drag from one node's edge to another node to create a connection. Click the button again to exit.\n            </span>\n          </div>\n        )}\n      </div>\n\n      <MemoryModal isOpen={isModalOpen} onClose={() => setIsModalOpen(false)} />\n\n      {selectedMemoryId && memories.find(m => m.id === selectedMemoryId) && (\n        <div className=\"memory-popup-overlay\" onClick={() => setSelectedMemoryId(null)}>\n          <div className=\"memory-popup-content\" onClick={e => e.stopPropagation()}>\n            <button className=\"popup-close-btn\" onClick={() => setSelectedMemoryId(null)}>\n              <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line>\n                <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line>\n              </svg>\n            </button>\n\n            <div className=\"popup-image-container\">\n              <img \n                src={memories.find(m => m.id === selectedMemoryId)!.image} \n                alt={memories.find(m => m.id === selectedMemoryId)!.title} \n                className=\"popup-image\" \n                loading=\"eager\"\n                decoding=\"async\"\n              />\n            </div>\n            <div className=\"popup-info\">\n              <h2 className=\"popup-title\">{memories.find(m => m.id === selectedMemoryId)!.title}</h2>\n              <p className=\"popup-description\">{memories.find(m => m.id === selectedMemoryId)!.description}</p>\n              \n              {memories.find(m => m.id === selectedMemoryId)!.tags && memories.find(m => m.id === selectedMemoryId)!.tags!.length > 0 && (\n                <div className=\"popup-tags\">\n                  {memories.find(m => m.id === selectedMemoryId)!.tags!.map(tag => (\n                    <span key={tag} className=\"popup-tag\">{tag}</span>\n                  ))}\n                </div>\n              )}\n\n              <div className=\"popup-date\">\n                {memories.find(m => m.id === selectedMemoryId)!.date ? (\n                  <>Memory Date: {new Date(memories.find(m => m.id === selectedMemoryId)!.date!).toLocaleDateString('en-US', {\n                    year: 'numeric',\n                    month: 'long',\n                    day: 'numeric'\n                  })}</>\n                ) : (\n                  <>Added: {new Date(memories.find(m => m.id === selectedMemoryId)!.createdAt).toLocaleDateString('en-US', {\n                    year: 'numeric',\n                    month: 'long',\n                    day: 'numeric'\n                  })}</>\n                )}\n              </div>\n\n              {/* Connections Section */}\n              {(() => {\n                const connectedMemories = getConnectedMemories(selectedMemoryId);\n                const hasConnections = connectedMemories.outgoing.length > 0 || connectedMemories.incoming.length > 0;\n                \n                return hasConnections && (\n                  <div className=\"popup-connections\">\n                    <h3 className=\"connections-title\">Connections</h3>\n                    \n                    {connectedMemories.outgoing.length > 0 && (\n                      <div className=\"connection-group\">\n                        <div className=\"connection-group-header\">\n                          <svg className=\"connection-icon\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                            <line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"></line>\n                            <polyline points=\"12 5 19 12 12 19\"></polyline>\n                          </svg>\n                          <span className=\"connection-label\">Outgoing Links ({connectedMemories.outgoing.length})</span>\n                        </div>\n                        <div className=\"connection-list\">\n                          {connectedMemories.outgoing.map(memory => (\n                            <div key={memory!.id} className=\"connection-item\" onClick={(e) => {\n                              e.stopPropagation();\n                              setSelectedMemoryId(memory!.id);\n                            }}>\n                              <img \n                                src={memory!.image} \n                                alt={memory!.title} \n                                className=\"connection-thumbnail\" \n                                loading=\"lazy\"\n                                decoding=\"async\"\n                              />\n                              <span className=\"connection-name\">{memory!.title}</span>\n                            </div>\n                          ))}\n                        </div>\n                      </div>\n                    )}\n                    \n                    {connectedMemories.incoming.length > 0 && (\n                      <div className=\"connection-group\">\n                        <div className=\"connection-group-header\">\n                          <svg className=\"connection-icon\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                            <line x1=\"19\" y1=\"12\" x2=\"5\" y2=\"12\"></line>\n                            <polyline points=\"12 19 5 12 12 5\"></polyline>\n                          </svg>\n                          <span className=\"connection-label\">Incoming Links ({connectedMemories.incoming.length})</span>\n                        </div>\n                        <div className=\"connection-list\">\n                          {connectedMemories.incoming.map(memory => (\n                            <div key={memory!.id} className=\"connection-item\" onClick={(e) => {\n                              e.stopPropagation();\n                              setSelectedMemoryId(memory!.id);\n                            }}>\n                              <img \n                                src={memory!.image} \n                                alt={memory!.title} \n                                className=\"connection-thumbnail\" \n                                loading=\"lazy\"\n                                decoding=\"async\"\n                              />\n                              <span className=\"connection-name\">{memory!.title}</span>\n                            </div>\n                          ))}\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                );\n              })()}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Delete Confirmation Dialog */}\n      {showDeleteConfirm && deleteTarget && (\n        <div className=\"delete-confirm-overlay\" onClick={cancelDelete}>\n          <div className=\"delete-confirm-dialog\" onClick={e => e.stopPropagation()}>\n            <div className=\"delete-confirm-icon\">\n              <svg width=\"48\" height=\"48\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n                <path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"></path>\n                <line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"></line>\n                <line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"></line>\n              </svg>\n            </div>\n            <h2 className=\"delete-confirm-title\">Delete Selected Items?</h2>\n            <p className=\"delete-confirm-message\">\n              {(() => {\n                const nodeCount = deleteTarget.nodes.length;\n                const edgeCount = deleteTarget.edges.length;\n                const totalCount = nodeCount + edgeCount;\n                \n                if (nodeCount > 0 && edgeCount > 0) {\n                  return `Are you sure you want to delete ${nodeCount} memor${nodeCount > 1 ? 'ies' : 'y'} and ${edgeCount} connection${edgeCount > 1 ? 's' : ''}?`;\n                } else if (nodeCount > 0) {\n                  return `Are you sure you want to delete ${nodeCount} memor${nodeCount > 1 ? 'ies' : 'y'}?`;\n                } else {\n                  return `Are you sure you want to delete ${edgeCount} connection${edgeCount > 1 ? 's' : ''}?`;\n                }\n              })()}\n              {deleteTarget.nodes.length > 0 && (\n                <span className=\"delete-warning\">\n                  <br /><br />\n                  ‚ö†Ô∏è Deleting memories will also remove all their connections.\n                </span>\n              )}\n            </p>\n            <div className=\"delete-confirm-actions\">\n              <button className=\"delete-confirm-cancel\" onClick={cancelDelete}>Cancel</button>\n              <button className=\"delete-confirm-delete\" onClick={confirmDelete}>Delete</button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default MemoryGraph;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}